var q=Object.defineProperty;var I=e=>{throw TypeError(e)};var R=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var E=(e,t,n)=>R(e,typeof t!="symbol"?t+"":t,n),G=(e,t,n)=>t.has(e)||I("Cannot "+n);var L=(e,t,n)=>(G(e,t,"read from private field"),n?n.call(e):t.get(e)),O=(e,t,n)=>t.has(e)?I("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function o({tagName:e,className:t,attributes:n={}}){const i=document.createElement(e);if(t){const a=t.split(" ").filter(Boolean);i.classList.add(...a)}return Object.keys(n).forEach(a=>i.setAttribute(a,n[a])),i}function K(e,t){const i=o({tagName:"div",className:`fighter-preview___root ${t==="right"?"fighter-preview___right":"fighter-preview___left"}`});if(!e)return i;const a=x(e),s=o({tagName:"div",className:"fighter-preview___info"}),c=o({tagName:"p"});c.innerHTML=`Name: <span class="fighter-preview__details">${e.name}</span>`;const u=o({tagName:"p"});u.innerHTML=`Health: <span class="fighter-preview__details">${e.health}</span>`;const p=o({tagName:"p"});p.innerHTML=`Attack: <span class="fighter-preview__details">${e.attack}</span>`;const g=o({tagName:"p"});return g.innerHTML=`Defense: <span class="fighter-preview__details">${e.defense}</span>`,s.append(c,u,p,g),i.append(a,s),i}function x(e){const{source:t,name:n}=e;return o({tagName:"img",className:"fighter-preview___img",attributes:{src:t,title:n,alt:n}})}const _={PlayerOneAttack:"KeyA",PlayerOneBlock:"KeyD",PlayerTwoAttack:"KeyJ",PlayerTwoBlock:"KeyL",PlayerOneCriticalHitCombination:["KeyQ","KeyW","KeyE"],PlayerTwoCriticalHitCombination:["KeyU","KeyI","KeyO"]};function B(e,t,n){const i=`hit ${t.map(g=>`hit__${g}`).join(" ")}`,a=t.includes("block")?`block__${t[1]}`:"hit",s=o({tagName:"div",className:i,attributes:{id:a}}),c=o({tagName:"div",className:"hit__container"});function u(){let g="";switch(t[0]){case"block":g=" is blocking ";break;case"critical":g="critical hit with damage ";break;default:g=" attack with damage ";break}return g}c.textContent=u();const p=o({tagName:"span",className:"hit__fighter"});if(p.textContent=e.name,!t.includes("block")){const g=o({tagName:"span",className:"hit__damage"});g.textContent=Math.round(n),c.append(g)}return c.prepend(p),s.append(c),s}const f=document.getElementById("root");async function J(e,t){return new Promise(n=>{const i={...e,currentHealth:e.health,isBlocking:!1,lastCriticalTime:0,pressedKeys:new Set},a={...t,currentHealth:t.health,isBlocking:!1,lastCriticalTime:0,pressedKeys:new Set},s=[{player:i,opponent:a,controls:{attack:_.PlayerOneAttack,block:_.PlayerOneBlock,critical:_.PlayerOneCriticalHitCombination},cssClass:"player1"},{player:a,opponent:i,controls:{attack:_.PlayerTwoAttack,block:_.PlayerTwoBlock,critical:_.PlayerTwoCriticalHitCombination},cssClass:"player2"}];console.log(s);let c=!1;const u=1e4,p=document.getElementById("left-fighter-indicator"),g=document.getElementById("right-fighter-indicator");console.log("playerOne ",i),console.log("playerTwo ",a);function H(r,d,m){r.style.width=`${Math.max(d/m*100,0)}%`}function C(r){c||(c=!0,document.removeEventListener("keydown",T),document.removeEventListener("keyup",F),n(r))}function S(r,d){return r.every(m=>d.has(m))}function j({player:r,controls:d,cssClass:m,opponent:l},y){console.log("player now : ",r),r.pressedKeys.add(y);const N=r.name===i.name?g:p;if(y===d.block&&(r.isBlocking=!0,console.log("player is blocking : ",r),document.getElementById(`block__${m}`)||f.append(B(r,["block",m]))),S(d.critical,r.pressedKeys)&&!r.isBlocking){const w=Date.now();if(w-r.lastCriticalTime>u){const P=r.attack*2;f.append(B(r,["critical",m],P)),l.currentHealth-=P,H(N,l.currentHealth,l.health),r.lastCriticalTime=w,r.pressedKeys.clear()}}if(y===d.attack&&!r.isBlocking){const w=W(r,l);console.log("opponent ",l.defense),l.currentHealth-=w,f.append(B(r,[m],w)),H(N,l.currentHealth,l.health)}}function T(r){const d=r.code,m=document.getElementById("hit");m==null||m.remove(),s.forEach(l=>{(d===l.controls.attack||d===l.controls.block||l.controls.critical.includes(d))&&(j(l,d),console.log("player is blocking : ",l))}),i.currentHealth<=0&&C(t),a.currentHealth<=0&&C(e)}function F(r){const d=r.code;s.forEach(({player:m,controls:l,cssClass:y})=>{var N;m.pressedKeys.delete(d),d===l.block&&(m.isBlocking=!1,(N=document.getElementById(`block__${y}`))==null||N.remove())})}document.addEventListener("keydown",T),document.addEventListener("keyup",F)})}function W(e,t){console.log("defender : ",t),console.log("defender is blocking : ",t.isBlocking);const n=Y(e),i=t.isBlocking?U(t):0;console.log("block power : ",i);const a=n-i;return a>0?a:0}function Y(e){const t=Math.random()+1;return e.attack*t}function U(e){const t=Math.random()+1;return e.defense*t}function Z(){const e=document.getElementsByClassName("modal-layer")[0];e==null||e.remove()}function z(e,t){const n=o({tagName:"div",className:"modal-header"}),i=o({tagName:"p",className:"modal-title"}),a=o({tagName:"div",className:"close-btn"});i.textContent=e,a.textContent="Ã—";const s=()=>{Z(),t()};return a.addEventListener("click",s),n.append(i,a),n}function Q({title:e,bodyElement:t,onClose:n}){const i=o({tagName:"div",className:"modal-layer"}),a=o({tagName:"div",className:"modal-root"}),s=z(e,n);return a.append(s,t),i.append(a),i}function V({title:e,bodyElement:t,onClose:n}){const i=Q({title:e,bodyElement:t,onClose:n});f.append(i)}function X(e){const t=document.getElementById("hit");t==null||t.remove();const n="Game is Over!",i=o({tagName:"div",className:"modal-body"}),a=o({tagName:"p",className:"modal-winner"});a.textContent="Winner is";const s=o({tagName:"span",className:"modal-winner-name"});s.textContent=e.name,a.append(s);const c=o({tagName:"img",className:"modal-img",attributes:{src:e.source,alt:e.name}});i.append(a,c),V({title:n,bodyElement:i,onClose:()=>{f.innerHTML="",v.startApplication()}})}function M(e,t){const n=x(e),a=o({tagName:"div",className:`arena___fighter ${t==="right"?"arena___right-fighter":"arena___left-fighter"}`});return a.append(n),a}function ee(e,t){const n=o({tagName:"div",className:"arena___battlefield"}),i=M(e,"left"),a=M(t,"right");return n.append(i,a),n}function A(e,t){const{name:n}=e,i=o({tagName:"div",className:"arena___fighter-indicator"}),a=o({tagName:"span",className:"arena___fighter-name"}),s=o({tagName:"div",className:"arena___health-indicator"}),c=o({tagName:"div",className:"arena___health-bar",attributes:{id:`${t}-fighter-indicator`}});return a.innerText=n,s.append(c),i.append(a,s),i}function te(e,t){const n=o({tagName:"div",className:"arena___fight-status"}),i=o({tagName:"div",className:"arena___versus-sign"}),a=A(e,"left"),s=A(t,"right");return n.append(a,i,s),n}function ne(e){const t=o({tagName:"div",className:"arena___root"}),n=te(...e),i=ee(...e);return t.append(n,i),t}async function ae(e){const t=ne(e);f.innerHTML="",f.append(t);const n=await J(...e);X(n)}const ie="/fight-binary-lecture-starter-js/assets/versus-eIzgoOcH.png",se=[{_id:"1",name:"Ryu",source:"https://media.giphy.com/media/kdHa4JvihB2gM/giphy.gif"},{_id:"2",name:"Dhalsim",source:"https://i.pinimg.com/originals/c0/53/f2/c053f2bce4d2375fee8741acfb35d44d.gif"},{_id:"3",name:"Guile",source:"https://66.media.tumblr.com/tumblr_lq8g3548bC1qd0wh3o1_400.gif"},{_id:"4",name:"Zangief",source:"https://media1.giphy.com/media/nlbIvY9K0jfAA/source.gif"},{_id:"5",name:"Ken",source:"https://i.pinimg.com/originals/46/4b/36/464b36a7aecd988e3c51e56a823dbedc.gif"},{_id:"6",name:"Bison",source:"http://www.fightersgeneration.com/np5/char/ssf2hd/bison-hdstance.gif"}],oe=[{_id:"1",name:"Ryu",health:45,attack:4,defense:3,source:"https://media.giphy.com/media/kdHa4JvihB2gM/giphy.gif"},{_id:"2",name:"Dhalsim",health:60,attack:3,defense:1,source:"https://i.pinimg.com/originals/c0/53/f2/c053f2bce4d2375fee8741acfb35d44d.gif"},{_id:"3",name:"Guile",health:45,attack:4,defense:3,source:"https://66.media.tumblr.com/tumblr_lq8g3548bC1qd0wh3o1_400.gif"},{_id:"4",name:"Zangief",health:60,attack:4,defense:1,source:"https://media1.giphy.com/media/nlbIvY9K0jfAA/source.gif"},{_id:"5",name:"Ken",health:45,attack:3,defense:4,source:"https://i.pinimg.com/originals/46/4b/36/464b36a7aecd988e3c51e56a823dbedc.gif"},{_id:"6",name:"Bison",health:45,attack:5,defense:4,source:"http://www.fightersgeneration.com/np5/char/ssf2hd/bison-hdstance.gif"}];function ce(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf(".json"),i=e.substring(t+1,n);return oe.find(a=>a._id===i)}async function re(e){const t=e==="fighters.json"?se:ce(e);return new Promise((n,i)=>{setTimeout(()=>t?n(t):i(Error("Failed to load data")),500)})}async function $(e,t="GET"){return re(e)}var k;class le{constructor(){O(this,k,"fighters.json")}async getFighters(){try{return await $(L(this,k))}catch(t){throw t}}async getFighterDetails(t){try{const n=`details/fighter/${t}.json`;return await $(n)}catch(n){throw n}}}k=new WeakMap;const D=new le,b=new Map;async function de(e){if(b.has(e))return b.get(e);try{const t=await D.getFighterDetails(e);return b.set(e,t),console.log(b),t}catch(t){throw console.err("Failed to load fighter details: ",t),t}}function me(e){ae(e)}function ge(e){const t=e.filter(Boolean).length===2,n=()=>{me(e)},i=o({tagName:"div",className:"preview-container___versus-block"}),a=o({tagName:"img",className:"preview-container___versus-img",attributes:{src:ie}}),c=o({tagName:"button",className:`preview-container___fight-btn ${t?"":"disabled"}`});return c.addEventListener("click",n,!1),c.innerText="Fight",i.append(a,c),i}function he(e){const t=document.querySelector(".preview-container___root"),[n,i]=e,a=K(n,"left"),s=K(i,"right"),c=ge(e);t.innerHTML="",t.append(a,c,s)}function fe(){let e=[];return async(t,n)=>{const i=await de(n),[a,s]=e;e=[a??i,a?s??i:s],he(e)}}function ue(e){const{source:t,name:n}=e;return o({tagName:"img",className:"fighter___fighter-image",attributes:{src:t,title:n,alt:n}})}function pe(e,t){const n=o({tagName:"div",className:"fighters___fighter"}),i=ue(e),a=s=>t(s,e._id);return n.append(i),n.addEventListener("click",a,!1),n}function _e(e){const t=fe(),n=o({tagName:"div",className:"fighters___root"}),i=o({tagName:"div",className:"preview-container___root"}),a=o({tagName:"div",className:"fighters___list"}),s=e.map(c=>pe(c,t));return a.append(...s),n.append(i,a),n}const h=class h{static async startApplication(){try{h.loadingElement.style.visibility="visible";const t=await D.getFighters(),n=_e(t);h.rootElement.appendChild(n)}catch(t){console.warn(t),h.rootElement.innerText="Failed to load data"}finally{h.loadingElement.style.visibility="hidden"}}};E(h,"rootElement",f),E(h,"loadingElement",document.getElementById("loading-backdrop"));let v=h;v.startApplication();
